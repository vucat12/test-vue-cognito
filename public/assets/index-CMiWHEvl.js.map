{"version":3,"mappings":"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","names":["useAuthStore","defineStore","idToken","decoded","jwtDecode","token","role","overrides","updates","_createElementVNode","_hoisted_1","_createVNode","_component_router_link","_cache","_component_router_view","modules","__vitePreload","n","lazy","path","normalized","loader","useSectionsStore","section","bundlesManifest","activated","loadManifest","res","isSectionActivated","activateSection","url","startTime","duration","e","installSectionActivationGuard","router","to","getRouteBySlug","routeConfig","route","routeGuard","from","next","auth","user","isAuthenticated","allDeps","getParentRouteDeps","r","deps","roleDeps","key","val","segments","parentPath","parent","toRouteRecord","rec","compPath","routeRecords","routesJson","createRouter","createWebHistory","matchedRoute","app","createApp","App","createPinia"],"ignoreList":[],"sources":["../../src/stores/useAuthStore.js","../../src/App.vue","../../src/utils/lazy.js","../../src/stores/sections.js","../../src/utils/sectionActivator.js","../../src/router/guards/sectionActivation.js","../../src/router/routeUtils.js","../../src/router/routeGuard.js","../../src/router/index.js","../../src/main.js"],"sourcesContent":["import { defineStore } from \"pinia\";\nimport { jwtDecode } from \"jwt-decode\";\n\nexport const useAuthStore = defineStore(\"auth\", {\n  state: () => ({\n    idToken: null,\n    currentUser: null,\n    simulate: null,\n  }),\n  actions: {\n    setTokenAndDecode(idToken) {\n      this.idToken = idToken;\n      const decoded = jwtDecode(idToken);\n      this.currentUser = {\n        email: decoded.email,\n        role: decoded[\"custom:role\"],\n        kycPassed: decoded[\"custom:kycPassed\"] === \"true\",\n        onboardingPassed: decoded[\"custom:onboardingPassed\"] === \"true\",\n        awsDataCheck: decoded[\"custom:awsDataCheck\"] === \"true\",\n        raw: decoded,\n      };\n    },\n    refreshFromStorage() {\n      const token = localStorage.getItem(\"idToken\");\n      if (token) this.setTokenAndDecode(token);\n    },\n    simulateRole(role, overrides = {}) {\n      this.simulate = { role, ...overrides };\n    },\n    updateUserAttributesLocally(updates) {\n      this.currentUser = { ...this.currentUser, ...updates };\n    },\n    logout() {\n      localStorage.clear();\n      this.$reset();\n    },\n  },\n  persist: true,\n});\n","<script setup>\nimport { useAuthStore } from \"@/stores/useAuthStore\";\nconst auth = useAuthStore();\n\n// Simulate a Creator user for testing fallbacks\nauth.simulateRole(\"creator\", { onboardingPassed: true, kycPassed: true });\n</script>\n\n<template>\n  <!-- Navigation Bar with Buttons -->\n  <nav style=\"padding: 1rem; background-color: #f0f0f0; display: flex; gap: 1rem;\">\n    <router-link to=\"/sign-up\">\n      <button style=\"padding: 0.5rem 1rem; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;\">\n        Sign Up\n      </button>\n    </router-link>\n    <router-link to=\"/log-in\">\n      <button style=\"padding: 0.5rem 1rem; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;\">\n        Log In\n      </button>\n    </router-link>\n    <router-link to=\"/dashboard\">\n      <button style=\"padding: 0.5rem 1rem; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;\">\n        Dashboard\n      </button>\n    </router-link>\n    <router-link to=\"/profile\">\n      <button style=\"padding: 0.5rem 1rem; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;\">\n        Profile\n      </button>\n    </router-link>\n    <router-link to=\"/discover\">\n      <button style=\"padding: 0.5rem 1rem; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;\">\n        Discover\n      </button>\n    </router-link>\n    <router-link to=\"/shop\">\n      <button style=\"padding: 0.5rem 1rem; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;\">\n        Shop\n      </button>\n    </router-link>\n    <!-- Button to toggle between creator and customer roles -->\n    \n  </nav>\n\n  <!-- Main content -->\n  <router-view />\n</template>\n\n<style scoped>\nnav {\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap;\n}\nbutton:hover {\n  background-color: #0056b3;\n}\n</style>","const modules = import.meta.glob(\"/src/components/**/*.vue\");\n\nexport function lazy(path) {\n  if (!path || typeof path !== \"string\") {\n    console.log(`Invalid path provided: \"${path}\".`);\n    return () => Promise.reject(new Error(\"lazy(): invalid path\"));\n  }\n  if (path.includes('App.vue')) {\n    console.log(`Attempted to lazily load App.vue.`);\n    return () => Promise.reject(new Error(\"lazy(): cannot dynamically load App.vue\"));\n  }\n  let normalized = path.replace(/^@\\/?/, \"/src/\");\n  if (!normalized.startsWith(\"/\")) {\n    normalized = `/${normalized}`;\n  }\n  const loader = modules[normalized];\n  if (!loader) {\n    console.log(`No module found for path \"${normalized}\".`);\n    return () => Promise.reject(new Error(`lazy(): component not found for path ${normalized}`));\n  }\n  return loader;\n}","import { defineStore } from \"pinia\";\n\nexport const useSectionsStore = defineStore(\"sections\", {\n  state: () => ({\n    activated: {\n      auth: false,\n      dashboard: false,\n      profile: false,\n      discover: false,\n      shop: false,\n      misc: false,\n    },\n  }),\n  actions: {\n    markActivated(section) {\n      this.activated[section] = true;\n    },\n    isActivated(section) {\n      if (this.activated[section]) {\n        console.log(`Section \"${section}\" already cached.`);\n        return true;\n      }\n      return false;\n    },\n  },\n});\n","let bundlesManifest = null\nconst activated = Object.create(null)\n\nasync function loadManifest() {\n  if (bundlesManifest) return bundlesManifest\n  try {\n    const manifestPath = import.meta.env.DEV ? '/public/section-bundles.json' : '/section-bundles.json';\n    const res = await fetch(manifestPath, { cache: 'no-cache' })\n    if (!res.ok) throw new Error(`HTTP ${res.status}`)\n    bundlesManifest = await res.json()\n    return bundlesManifest\n  } catch (e) {\n    console.log(`Failed to load section-bundles.json: ${e.message}`)\n    return {}\n  }\n}\n\nexport async function isSectionActivated(section) {\n  if (activated[section]) {\n    console.log(`[CACHE_HIT] Using preloaded ${section} bundle`)\n    return true\n  }\n  return false\n}\n\nexport async function activateSection(section) {\n  if (activated[section]) return true\n  const manifest = await loadManifest()\n  const url = manifest[section]\n  if (!url) {\n    console.log(`No bundle found for section \"${section}\".`)\n    return false\n  }\n\n  const startTime = performance.now()\n  console.log(`Preload section \"${section}\" and its assets`)\n  console.log(`[SECTION_BUNDLE] Loading ${section} bundle: ${url}`)\n\n  try {\n    const importUrl = import.meta.env.DEV ? url.replace('/assets/', '/public/assets/') : url;\n    await import(/* @vite-ignore */ importUrl)\n    activated[section] = true\n    console.log(`[SECTION_ACTIVATED] All ${section} components now available`)\n    const duration = performance.now() - startTime\n    console.log(`Preload \"${section}\" Assets and section \"${section}\" cached`)\n    console.log(`Preloading completed in ${duration.toFixed(2)}ms`)\n    return true\n  } catch (e) {\n    console.log(`Failed to preload section \"${section}\": ${e.message}`)\n    return false\n  }\n}","import { useSectionsStore } from '@/stores/sections'\nimport { activateSection, isSectionActivated } from '@/utils/sectionActivator'\n\nexport function installSectionActivationGuard(router) {\n  router.afterEach(async (to) => {\n    const section = to.meta?.section\n    if (!section) return\n\n    if (await isSectionActivated(section)) return\n\n    requestIdleCallback\n      ? requestIdleCallback(async () => {\n          const ok = await activateSection(section)\n          if (ok) useSectionsStore().markActivated(section)\n        })\n      : setTimeout(async () => {\n          const ok = await activateSection(section)\n          if (ok) useSectionsStore().markActivated(section)\n        }, 0)\n  })\n}","import routeConfig from \"./routeConfig.json\";\n\nexport function getRouteBySlug(path) {\n  return routeConfig.find(\n    (route) =>\n      route.slug === path ||\n      (route.dynamicRoute &&\n        path.match(new RegExp(route.slug.replace(/:[^/]+/g, \"[^/]+\"))))\n  );\n}\n","import { useAuthStore } from \"@/stores/useAuthStore\";\nimport { getRouteBySlug } from \"./routeUtils\";\n\nexport default function routeGuard(to, from, next) {\n  const route = getRouteBySlug(to.path);\n  const auth = useAuthStore();\n\n  const user = auth.simulate || auth.currentUser;\n\n  if (!route) return next(\"/404\");\n\n  // Auth checks (added)\n  let isAuthenticated = !!user;\n  // Bypass auth temporarily: force true for all auth guards as per instructions\n  isAuthenticated = true; // Comment this out later when adding Cognito\n\n  if (route.requiresAuth && !isAuthenticated) {\n    return next(route.redirectIfNotAuth || \"/log-in\");\n  }\n\n  if (!route.requiresAuth && isAuthenticated && route.redirectIfLoggedIn) {\n    return next(route.redirectIfLoggedIn);\n  }\n\n  // Role checks\n  if (\n    route.supportedRoles?.length &&\n    ![\"any\", \"all\"].includes(route.supportedRoles[0]) &&\n    !route.supportedRoles.includes(user?.role)\n  ) {\n    return next(\"/dashboard\");\n  }\n\n  // Dependency checks\n  const parentDeps = route.inheritConfigFromParent\n    ? getParentRouteDeps(to.path)\n    : [];\n  const allDeps = [...parentDeps, route];\n\n  for (const r of allDeps) {\n    if (!r) continue;\n\n    const deps = r.dependencies || {};\n    const roleDeps = deps.roles?.[user?.role] || {};\n\n    for (const [key, val] of Object.entries(roleDeps)) {\n      if (val.required && !user?.[key]) return next(val.fallbackSlug || \"/404\");\n    }\n\n    for (const [key, val] of Object.entries(deps)) {\n      if (key !== \"roles\" && val.required && !user?.[key])\n        return next(val.fallbackSlug || \"/404\");\n    }\n  }\n\n  next();\n}\n\nfunction getParentRouteDeps(path) {\n  const segments = path.split(\"/\");\n  segments.pop();\n  const parentPath = segments.join(\"/\") || \"/\";\n  const parent = getRouteBySlug(parentPath);\n  return parent ? [parent] : [];\n}","import { createRouter, createWebHistory } from \"vue-router\";\nimport routesJson from \"@/router/routeConfig.json\";\nimport { lazy } from \"@/utils/lazy\";\nimport { installSectionActivationGuard } from \"./guards/sectionActivation\";\nimport { useSectionsStore } from \"@/stores/sections\";\nimport routeGuard from \"./routeGuard\";\nimport { useAuthStore } from \"@/stores/useAuthStore\";\n\nfunction toRouteRecord(r) {\n  const rec = {\n    path: r.slug,\n    meta: r,\n  };\n\n  if (r.redirect) {\n    rec.redirect = r.redirect;\n  } else if (r.customComponentPath) {\n    rec.component = () => {\n      const auth = useAuthStore();\n      const role = auth.simulate?.role || auth.currentUser?.role || \"default\";\n      const compPath = r.customComponentPath[role]?.componentPath;\n      return compPath ? lazy(compPath)() : import(\"@/components/NotFound.vue\");\n    };\n  } else {\n    rec.component = r.componentPath\n      ? lazy(r.componentPath)\n      : () => import(\"@/components/NotFound.vue\");\n  }\n\n  return rec;\n}\n\nconst routeRecords = routesJson.map(toRouteRecord);\nconst router = createRouter({\n  history: createWebHistory(import.meta.env.BASE_URL),\n  routes: routeRecords,\n});\n\nrouter.beforeEach((to, from, next) => {\n  console.log(`Route request for \"${to.path}\"`);\n  console.log(`Checking route configuration.`);\n  const matchedRoute = routeRecords.find((r) => r.path === to.path);\n  if (!matchedRoute) {\n    console.log(`404 do nothing more!!!`);\n    next(\"/404\");\n  } else {\n    console.log(`Route found in configuration.`);\n    console.log(\n      `Configuration data for the route is ${JSON.stringify(\n        matchedRoute.meta\n      )}.`\n    );\n    const section = matchedRoute.meta?.section;\n    if (section) {\n      console.log(`Route belongs to section \"${section}\".`);\n    }\n    next();\n  }\n});\n\nrouter.beforeEach(routeGuard);\ninstallSectionActivationGuard(router);\n\nrouter.isReady().then(() => {\n  const store = useSectionsStore();\n  const auth = useAuthStore();\n  auth.refreshFromStorage();\n});\n\nexport default router;\n","import { createApp } from \"vue\";\nimport { createPinia } from \"pinia\";\nimport piniaPluginPersistedstate from \"pinia-plugin-persistedstate\";\n\nimport App from \"./App.vue\";\nimport router from \"./router\";\nimport \"./assets/main.css\";\n\nconst app = createApp(App);\n\napp.use(createPinia());\napp.use(router);\n\nif (import.meta.env?.MODE === \"eager\") {\n  await import(\"./eager\");\n}\n\napp.mount(\"#app\");\n"],"file":"assets/index-CMiWHEvl.js"}